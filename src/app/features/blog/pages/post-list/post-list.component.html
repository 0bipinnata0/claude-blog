<div class="container">
    <div class="header">
        <h1>Latest Articles</h1>
        <p class="subtitle">Insights on Angular, Material Design, and modern web development</p>
    </div>

    <!-- Category Switcher -->
    <div class="category-tabs" appTabs [selectedValue]="selectedTag()" (selectedValueChange)="selectedTag.set($event)">
        @for (tag of tags(); track tag) {
        <button appTab [value]="tag" class="tab-button" (click)="selectedTag.set(tag)">
            {{ tag }}
        </button>
        }
    </div>

    <div class="bento-grid" appTabPanel>
        @for (post of filteredPosts(); track post.id; let idx = $index) {
        <a appSpotlight [routerLink]="['/post', post.slug]" class="bento-card" [class.featured]="idx === 0"
            [class.wide]="idx > 0 && (idx + 1) % 4 === 0" [style.view-transition-name]="'card-' + post.slug">

            <!-- Background Image (Full bleed for featured/wide cards) -->
            <div class="card-image">
                <img [ngSrc]="post.coverImage" [alt]="post.title" [style.view-transition-name]="'img-' + post.slug"
                    [priority]="idx < 2" fill>
                @if (idx === 0 || (idx > 0 && (idx + 1) % 4 === 0)) {
                <div class="image-overlay"></div>
                }
            </div>

            <!-- Content -->
            <div class="card-content" [class.overlay-content]="idx === 0 || (idx > 0 && (idx + 1) % 4 === 0)">
                <div class="card-meta">
                    <mat-icon>calendar_today</mat-icon>
                    <span>{{ post.date | date: 'MMM d, yyyy' }}</span>
                </div>
                <h2 class="card-title">{{ post.title }}</h2>
                @if (idx !== 0 && !((idx > 0 && (idx + 1) % 4 === 0))) {
                <p class="card-summary">{{ post.summary }}</p>
                }
                <div class="card-action">
                    <span>Read Article</span>
                    <mat-icon>arrow_forward</mat-icon>
                </div>
            </div>
        </a>
        }
    </div>
</div>